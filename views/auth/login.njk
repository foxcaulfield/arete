{% extends "layouts/base.njk" %}

{% block content %}
	<div class="card auth-card">
		<h1>Login</h1>
		<form
			hx-post="/api/auth/sign-in/email"
			hx-trigger="submit"
			hx-swap="none"
			hx-on::after-request="
				if(event.detail.xhr.status===200){
					toast.success('Welcome back!');
					setTimeout(function(){ window.location='/ui/profile'; }, 600);
				} else {
					try {
						const err=JSON.parse(event.detail.xhr.responseText);
						toast.error(err.message || 'Login failed');
					} catch(e){
						toast.error('Login failed');
					}
				}"
		>
			<div class="form-group">
				<label for="email">Email</label>
				<input type="email" id="email" name="email" placeholder="you@example.com" required/>
			</div>
			<div class="form-group">
				<label for="password">Password</label>
				<input type="password" id="password" name="password" placeholder="••••••••" required/>
			</div>
			<button type="submit" class="primary">Login</button>
		</form>
		<p class="auth-footer">No account? <a href="/ui/auth/signup">Sign up</a></p>
	</div>
{% endblock %}