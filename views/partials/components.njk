{% macro collectionTableHeader() %}
	<tr>
		<th class="col-name">Name</th>
		<th class="col-description hide-mobile">Description</th>
		<th class="col-exercises">Exercises</th>
		<th class="col-coverage">Coverage</th>
		<th class="col-attempts hide-tablet">Attempts</th>
		<th class="col-actions">Actions</th>
	</tr>
{% endmacro %}

{% macro collectionTableRow(collectionUnit) %}
	<tr>
		<td class="col-name">
			<a href="/ui/collections/{{ collectionUnit.id }}" class="cell-link">
				<div class="cell-primary">{{ collectionUnit.name }}</div>
				<div class="cell-secondary hide-desktop">{{ collectionUnit.user.name or "‚Äî" }}</div>
			</a>
		</td>
		<td class="col-description hide-mobile">
			<span class="text-truncate">{{ collectionUnit.description or "‚Äî" }}</span>
		</td>
		<td class="col-exercises text-center">{{ collectionUnit.exerciseCount or 0 }}</td>
		<td class="col-coverage text-center">
			<span class="coverage-badge {% if (collectionUnit.coverage | int) >= 75 %}coverage-badge--success{% elif (collectionUnit.coverage | int) >= 25 %}coverage-badge--warning{% endif %}">
				{{ collectionUnit.coverage or 0 }}%
			</span>
		</td>
		<td class="col-attempts text-center hide-tablet">{{ collectionUnit.attemptCount or 0 }}</td>
		<td class="col-actions">
			<a href="/ui/collections/{{ collectionUnit.id }}" class="table-action-btn" title="View">üëÅÔ∏è</a>
			<a href="/ui/quiz/{{ collectionUnit.id }}" class="table-action-btn table-action-btn--primary" title="Start Quiz">‚ñ∂</a>
		</td>
	</tr>
{% endmacro %}

{% macro exerciseTableHeader() %}
	<tr>
		<th class="col-question">Question</th>
		<th class="col-answer hide-mobile">Answer</th>
		<th class="col-type hide-tablet">Type</th>
		<th class="col-media hide-tablet">Media</th>
		<th class="col-accuracy">Accuracy</th>
		<th class="col-actions">Actions</th>
	</tr>
{% endmacro %}

{% macro exerciseTableRow(exerciseUnit) %}
	{% set total = exerciseUnit.totalAttempts or 0 %}
	{% set correct = exerciseUnit.correctAttempts or 0 %}
	{% set accuracy = (correct / total * 100) if total > 0 else 0 %}
	<tr>
		<td class="col-question">
			<a href="/ui/exercises/{{ exerciseUnit.id }}" class="cell-link">
				<div class="cell-primary text-truncate">{{ exerciseUnit.question | truncate(60) }}</div>
			</a>
			<div class="cell-secondary hide-desktop">
			{% if exerciseUnit.type == 'CHOICE_SINGLE' %}Choice{% else %}Fill-in{% endif %}
			{% if exerciseUnit.imageUrl or exerciseUnit.audioUrl %}
					{% if exerciseUnit.imageUrl %}<span class="cell-secondary__media">üì∑</span>{% endif %}
					{% if exerciseUnit.audioUrl %}<span class="cell-secondary__media">üéµ</span>{% endif %}
				{% endif %}
				{% if total > 0 %}<span class="cell-secondary__stats">{{ correct }}/{{ total }}</span>{% endif %}
			</div>
		</td>
		<td class="col-answer hide-mobile">
			<span class="text-truncate">{{ exerciseUnit.correctAnswer | truncate(30) }}</span>
		</td>
		<td class="col-type hide-tablet">
			<span class="badge badge--type">
				{% if exerciseUnit.type == 'CHOICE_SINGLE' %}Choice{% else %}Fill-in{% endif %}
			</span>
		</td>
		<td class="col-media hide-tablet">
			<span class="media-indicators">
				{% if exerciseUnit.imageUrl %}
					<span class="media-indicator media-indicator--image" title="Has image">üì∑</span>
				{% endif %}
				{% if exerciseUnit.audioUrl %}
					<span class="media-indicator media-indicator--audio" title="Has audio">üéµ</span>
				{% endif %}
				{% if not exerciseUnit.imageUrl and not exerciseUnit.audioUrl %}
					<span class="media-indicator media-indicator--none">‚Äî</span>
				{% endif %}
			</span>
		</td>
		<td class="col-accuracy text-center">
			{% if total > 0 %}
				<span class="accuracy-display {% if accuracy >= 75 %}accuracy--good{% elif accuracy >= 50 %}accuracy--medium{% else %}accuracy--poor{% endif %}">
					{{ accuracy | round }}%
				</span>
				<span class="cell-secondary">{{ correct }}/{{ total }}</span>
			{% else %}
				<span class="text-muted">‚Äî</span>
			{% endif %}
		</td>
		<td class="col-actions">
			<a href="/ui/exercises/{{ exerciseUnit.id }}" class="table-action-btn" title="View">üëÅÔ∏è</a>
			<a href="/ui/exercises/{{ exerciseUnit.id }}/edit" class="table-action-btn" title="Edit">‚úèÔ∏è</a>
		</td>
	</tr>
{% endmacro %}

{% macro questionTypeBlock(questionType) %}
	<div class="question-type-block">
		<span class="question-type-icon-wrap">
			{% if questionType === "CHOICE_SINGLE" %}
				{% include "icons/squares-2x2.njk" %}
			{% elif questionType === "FILL_IN_THE_BLANK" %}
				{% include "icons/document-text.njk" %}
			{% else %}
				{% include "icons/question-mark-circle.njk" %}
			{% endif %}
		</span>

		<div class="question-type-text">
			<div class="question-type-title">
				{% if questionType === "CHOICE_SINGLE" %}
					Single choice
				{% elif questionType === "FILL_IN_THE_BLANK" %}
					Fill in the blank
				{% else %}
					Unknown type
				{% endif %}
			</div>
			<div class="question-type-desc">
				{% if questionType === "CHOICE_SINGLE" %}
					Choose one correct answer.
				{% elif questionType === "FILL_IN_THE_BLANK" %}
					Type the missing word or phrase.
				{% else %}
					Question type information.
				{% endif %}
			</div>
		</div>
	</div>
	<style>
		.question-type-block {
			display: inline-flex;
			align-items: center;
			gap: 0.6rem; /* similar to gap-2.4 */
			margin: 0.25rem 0;
			justify-content: end;
		}

		.question-type-icon-wrap {
			display: inline-flex;
			align-items: center;
			justify-content: center;
			width: 2.5rem; /* w-10 */
			height: 2.5rem; /* h-10 */
			border-radius: 0.5rem; /* rounded-lg */
			color: var(--muted); /* text-slate-500 */
			flex-shrink: 0;
		}

		.question-type-icon-wrap svg {
			width: 1.5rem; /* ~24px */
			height: 1.5rem;
		}

		.question-type-text {
			display: flex;
			flex-direction: column;
		}

		.question-type-title {
			font-weight: 600;
			font-size: 0.875rem;
		}

		.question-type-desc {
			font-size: 0.75rem;
			color: var(--muted);
		}
	</style>
{% endmacro %}
